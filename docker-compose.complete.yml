version: '3.8'

services:
  elidune-complete:
    image: ${ELIDUNE_IMAGE:-elidune-complete:latest}
    container_name: elidune-complete
    ports:
      - "${POSTGRES_PORT:-5433}:5432"
      - "${REDIS_PORT:-6379}:6379"
      - "${API_PORT:-8282}:8080"
      - "${GUI_PORT:-8181}:80"
    environment:
     
    volumes:
      - /etc/elidune/config:/app/config
      - postgres_data:/var/lib/postgresql/data
      - redis_data:/data
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U elidune -d elidune && redis-cli ping"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 60s

volumes:
  postgres_data:
    name: elidune-postgres-data
  redis_data:
    name: elidune-redis-data

networks:
  default:
    name: elidune-network
